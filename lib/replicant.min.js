(function(a){var b,c;b=function(a,b){return a===""?b:""+a+"."+b},c=function(a,b,c,d){var e,f,g;return g=_(a).isObject(),e=_(a).isArray(),f=_(a).isFunction(),!f&&(g||e)?e?b():c():d()};var d;d=function(a,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w;return u=this,w=a,r={},q=h||"",p=function(){},u.name="ArrayProxy",l=i||p,t=j||p,k=function(a,b,c){return Object.defineProperty(u,a,{get:function(){return b[c]},set:function(a){return b[c]=a},configurable:!0}),l(a,b,c)},s=function(a){return delete u[a],t(a)},o=function(a,b){return f(a,b)},v=function(a,b,c){return g(a,b,c)},n=function(a,b,h){var i;i=w[h];if(a||r[h]===void 0)r[h]=c(i,function(){return new d(i,f,g,b,k,s)},function(){return new e(i,f,g,b,k,s)},function(){return i});return r[h]},m=function(a){var c;return c=b(q,a),l(c,r[a]),n(!1,c,a),Object.defineProperty(u,a,{get:function(){var b;return b=n(!1,c,a),o(c,b),b},set:function(b){var d,e;return e=r[a],w[a]=b,d=n(!0,c,a),v(c,d,e)},configurable:!0,enumerable:!0})},Object.defineProperty(u,"length",{get:function(){return w.length}}),this.push=function(a){var c,d;return d=w.length,w.push(a),m(d),c=b(q,d),v(c,a,void 0)},this.unshift=function(a){var c,d;return d=w.length,w.push(a),m(r,d),c=b(q,d),v(c,a,w[1])},this.pop=function(){var a,c,d;return d=w.pop(),c=w.length-1,a=b(q,c),v(a,void 0,d),delete u[w.length],d},this.shift=function(){var a,c;return c=w.shift(),a=b(q,"0"),v(0,void 0,c),delete u[w.length],c},_(a).chain().keys().each(function(a){return m(a)}),u};var e;e=function(a,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return y=this,q=[],r=[],v={},u=h||(h=""),t=function(){},l=i,x=j,p=function(){var a;return a=q,q=[],a},s=function(){var a;return a=r,r=[],a},y.name="ObjectProxy",k=function(a,b,c){Object.defineProperty(y,a,{get:function(){return b[c]},set:function(a){return b[c]=a},configurable:!0});if(l)return l(a,b,c)},w=function(a){return delete y[a],x(a)},o=function(a,b){return f(a,b),q.push(a)},z=function(a,b,c){return g(a,b,c),r.push(a)},n=function(b,h,i){var j;j=a[i];if(b||v[i]===void 0)v[i]=c(j,function(){return new d(j,f,g,h,k,w)},function(){return new e(j,f,g,h,k,w)},function(){return j});return v[i]},m=function(c,d,e){var f;return f=b(u,e),l?l(f,c,e):k(f,c,e),n(!1,f,e),Object.defineProperty(c,e,{get:function(){var a;return a=n(!1,f,e),o(f,a),a},set:function(b){var c,g;return g=d[e],a[e]=b,c=n(!0,f,e),z(f,c,g)},configurable:!0,enumerable:!0})},Object.defineProperty(y,"length",{get:function(){return v.length}}),_(a).chain().keys().each(function(a){return m(y,v,a)}),y};var f,g,h,i,j,k,l,m=Object.prototype.hasOwnProperty,n=function(a,b){function d(){this.constructor=a}for(var c in b)m.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};g=function(){function a(a,c){this.element=a,this.fqn=c===""||c===void 0?this.element.id:b(c,this.element.id),this.crawl(this,this.fqn,this.element,this.crawl,this.addChild),this}return a.prototype.addChild=function(a,c,d,e){var f;return f=b(c,d),a[f]=l(e,c)},a.prototype.crawl=function(a,b,c,d,e){if(c.children!==void 0&&c.children.length>0)return _(c.children).chain().each(function(c){return e(a,b,c.id,c),d(a,b,c,d,e)})},a}(),f=function(){function a(){a.__super__.constructor.apply(this,arguments)}return n(a,g),a.prototype.write=function(a,b){var c,d,e,f,g;if(a===this.fqn){if(_.isObject(b)){g=[];for(e=0,f=b.length;e<f;e++)d=b[e],g.push(this[d].write(b[d]));return g}return $(this.element).text(b)}return c=this[a],c.write(a,b)},a}(),j=function(){function a(){a.__super__.constructor.apply(this,arguments)}return n(a,g),a.prototype.write=function(a,b){var c;return a===this.fqn?$(this.element).text(b):(c=this[a],c.write(a,b))},a}(),h=function(){function a(){a.__super__.constructor.apply(this,arguments)}return n(a,g),a.prototype.write=function(a,b){var c;return a===this.fqn?$(this.element).val(b):(c=this[a],c.write(a,b))},a}(),k=function(){function a(){a.__super__.constructor.apply(this,arguments)}return n(a,g),a.prototype.write=function(a,b){var c,d,e,f;if(a!==this.fqn)return f=this[a],f.write(a,b);c=$(this.element).children("li");if(c.length<b.length)return e=c[0],d=0,_(b).each(function(a){var b;return b=$(e).clone().attr("id",d).appendTo(element),self[fqn+"."+d]=b[0],d++})},a}(),i=function(){function a(){a.__super__.constructor.apply(this,arguments)}return n(a,g),a.prototype.write=function(a,b){if(a===this.fqn)return $(this.element).text(b)},a}(),l=function(a,b){var c;return this.div=function(a,b){return new f(a,b)},this.span=function(a,b){return new j(a,b)},this.input=function(a,b){return new h(a,b)},this.ul=function(a,b){return new k(a,b)},this.li=function(a,b){return new i(a,b)},_.isString(a)?(c=$(a)[0],this[c.tagName.toLowerCase()](c,b)):this[a.tagName.toLowerCase()](a,b)};var o;o=function(a,b){var c,e,f;return this.element=$(a)[0],this.map=function(){},this.html=DOMBuilder.dom,e=function(a,b){var c;return b===void 0||b===""?c=a:a===void 0||a===""?c=b:c=""+a+"."+b,c},this.fqn=e(b,this.element.id),c=function(a,b,g,h){var i,j,k,l,m;return l=h.id,k=e(g,l),m=h.tagName.toUpperCase(),a=a||b,h.children!==void 0&&h.children.length>0?(j=function(){var d,e,f,g;f=h.children,g=[];for(d=0,e=f.length;d<e;d++)i=f[d],g.push(c(a,b,k,i));return g}(),function(a,c,g,i){var n,o,p,q,r,s,t,u;n=l===""?i:l,s=e(g,n),t=n===k||n===void 0?c:c[n];if(t instanceof d){r=[];for(q=0,u=t.length-1;0>u?q>=u:q<=u;0>u?q--:q++)r.push(function(){var b,c,d;d=[];for(b=0,c=j.length;b<c;b++)o=j[b],d.push(o(a,t,s,q));return d}());return f(a,m,h,n,r,b,c)}return p=function(){var b,c,d;d=[];for(b=0,c=j.length;b<c;b++)o=j[b],d.push(o(a,t,s));return d}(),f(a,m,h,n,p,b,c)}):function(c,g,i,j){var n,o,p,q,r,s;n=l===""?j:l,q=e(i,n),r=n===k?g:g[n];if(r instanceof d){p=[];for(o=0,s=r.length-1;0>s?o>=s:o<=s;0>s?o--:o++)p.push(f(c,m,h,o,r[o],b,g));return p}return h=f(c,m,h,n,r,b,g),a[q]=h,h}},f=function(a,b,c,d,e,f,g){var h,i,j;return j={},h=e?e:c.textContent,d&&(j.id=d),c.className&&(j["class"]=c.className),c.type&&(j.type=c.type),i=a[b](j,h),g[d]&&(g[d].onclick&&(i.onclick=g[d].onclick.bind(f)),g[d].onblur&&(i.onblur=g[d].onblur.bind(f)),g[d].text&&(i.value=g[d].text,i.textContent=g[d].text),g[d].visible!==void 0&&(i.hidden=!g[d].visible)),i},this.map=function(a){var d;return d=c(this,a,b,this.element,this.map),d(this.html,a)},this};var p;p={"default":{onGet:function(a,b){return console.log("read: "+a+" -> "+b)},onSet:function(a,b,c){return console.log("wrote: "+a+". "+c+" -> "+b)},namespace:""},create:function(a,b,f,g){var h,i;return h=b||(b=this["default"].onGet),i=f||(f=this["default"].onSet),g=g||(g=this["default"].namespace),c(a,function(){return new d(a,h,i,g)},function(){return new e(a,h,i,g)},function(){return a})},scan:function(a,b){return l(a,b)},map:function(a){return new o(a,"")}},a.replicant=p})(window)