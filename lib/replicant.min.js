(function(a){var b,c;b=function(a,b){return a===""?b:""+a+"."+b},c=function(a,b,c,f,g){var h,i,j,k;return j=_(a).isObject(),h=_(a).isArray(),i=_(a).isFunction(),k=a instanceof e||a instanceof d,k?f():!i&&(j||h)?h?b():c():g()};var d;d=function(a,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w;return u=this,w=a,r={},q=h||"",p=function(){},u.name="ArrayProxy",l=i||p,t=j||p,k=function(a,b,c){return Object.defineProperty(u,a,{get:function(){return b[c]},set:function(a){return b[c]=a},configurable:!0}),l(a,b,c)},s=function(a){return delete u[a],t(a)},o=function(a,b){return f(u,a,b)},v=function(a,b,c){return g(u,a,b,c)},n=function(a,b,h){var i;i=w[h];if(a||r[h]===void 0)r[h]=c(i,function(){return new d(i,f,g,b,k,s)},function(){return new e(i,f,g,b,k,s)},function(){return _(i).chain().keys().each(function(a){return k(""+b+"."+a,i,a),i})},function(){return i});return r[h]},m=function(a){var c;return c=b(q,a),l(c,r[a]),n(!1,c,a),Object.defineProperty(u,a,{get:function(){var b;return b=n(!1,c,a),o(c,b),b},set:function(b){var d,e;return e=r[a],w[a]=b,d=n(!0,c,a),v(c,d,e)},configurable:!0,enumerable:!0})},Object.defineProperty(u,"length",{get:function(){return w.length}}),this.push=function(a){var c,d;return d=w.length,w.push(a),m(d),c=b(q,d),v(c,u[w.length-1],void 0)},this.unshift=function(a){var c,d;return d=w.length,w.push(a),m(r,d),c=b(q,d),v(c,u[0],u[1])},this.pop=function(){var a,c,d;return d=u[w.length-1],w.pop(),c=w.length-1,a=b(q,c),v(a,void 0,d),delete u[w.length],d},this.shift=function(){var a,c;return c=u[0],w.shift(),a=b(q,"0"),v(0,void 0,c),delete u[w.length],c},_(a).chain().keys().each(function(a){return m(a)}),u};var e;e=function(a,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return y=this,q=[],r=[],v={},u=h||(h=""),t=function(){},l=i,x=j,p=function(){var a;return a=q,q=[],a},s=function(){var a;return a=r,r=[],a},y.name="ObjectProxy",k=function(a,b,c){Object.defineProperty(y,a,{get:function(){return b[c]},set:function(a){return b[c]=a},configurable:!0});if(l)return l(a,b,c)},w=function(a){return delete y[a],x(a)},o=function(a,b){return f(y,a,b),q.push(a)},z=function(a,b,c){return g(y,a,b,c),r.push(a)},n=function(b,h,i){var j;j=a[i];if(b||v[i]===void 0)v[i]=c(j,function(){return new d(j,f,g,h,k,w)},function(){return new e(j,f,g,h,k,w)},function(){return _(j).chain().keys().each(function(a){return k(""+h+"."+a,j,a),j})},function(){return j});return v[i]},m=function(c,d,e){var f;return f=b(u,e),l?l(f,c,e):k(f,c,e),n(!1,f,e),Object.defineProperty(c,e,{get:function(){var a;return a=n(!1,f,e),o(f,a),a},set:function(b){var c,g;return g=d[e],a[e]=b,c=n(!0,f,e),z(f,c,g)},configurable:!0,enumerable:!0})},Object.defineProperty(y,"length",{get:function(){return v.length}}),_(a).chain().keys().each(function(a){return m(y,v,a)}),y};var f;f=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o;return this.element=$(a)[0],this.map=function(){},this.html=DOMBuilder.dom,this.template={},h=function(a,b){var c;return b===void 0||b===""?c=a:a===void 0||a===""?c=b:c=""+a+"."+b,c},this.fqn=h(b,this.element.id),this.eventChannel=postal.channel(this.fqn+"_events"),c=this.eventChannel,m=function(a){return postal.channel(a.fqn+"_model").subscribe(function(b){var c,d,e,f,g,h;if(b.event==="wrote")return e=a[b.key],f=b.key.lastIndexOf("."),h=b.key.substring(0,f),d=b.key.substring(f+1),d==="value"&&!e&&(e=a[h]),e?(e.value=b.value,e.textContent=b.value):(c=h+"_add",g=a.template[c](d,b.parent),$(a[h]).append(g))})},m(this),i={click:"onclick",dblclick:"ondblclick",mousedown:"onmousedown",mouseup:"onmouseup",mouseove:"onmouseover",mousemove:"onmousemove",mouseout:"onmouseout",keydown:"onkeydown",keypress:"onkeypress",keyup:"onkeyup",select:"onselect",change:"onchange",focus:"onfocus",blur:"onblur",scroll:"onscroll",resize:"onresize",submit:"onsubmit"},k={hide:"hidden",value:["value","textContent"]},n={id:"id",name:"name","class":"className",type:"type"},g=function(a,b,c,e){var f,i,k,l,m,n;return m=e.id,l=h(c,m),n=e.tagName.toUpperCase(),a=a||b,e.children!==void 0&&e.children.length>0?(k=function(){var c,d,f,h;f=e.children,h=[];for(c=0,d=f.length;c<d;c++)i=f[c],h.push(g(a,b,l,i));return h}(),f=function(c,f,g,i){var o,p,q,r,s,t,u,v,w,x;o=m===""?i:m,v=h(g,o),w=o===l||o===void 0?f:f[o];if(w instanceof d){u=[],r=k[0],a.template[v+"_add"]=function(a,b){return r(c,b,v,a)};for(t=0,x=w.length-1;0>x?t>=x:t<=x;0>x?t--:t++)u.push(r(c,w,v,t));return q=j(a,c,n,e,v,o,u,b,f),a[v]=q,q}return s=function(){var a,b,d;d=[];for(a=0,b=k.length;a<b;a++)p=k[a],d.push(p(c,w,v));return d}(),q=j(a,c,n,e,v,o,s,b,f),a[v]=q,q},a.template[l]=f,f):(f=function(c,d,f,g){var i,k,o,p;return i=m===""?g:m,o=h(f,i),p=i===l?d:d[i],k=j(a,c,n,e,o,i,p,b,d),a[o]=k,k},a.template[l]=f,f)},j=function(a,b,c,d,e,g,h,i,j){var m,o,p;p={},m=h?h:d.textContent;if(g||g===0)p.id=g;return c==="INPUT"&&(p.value=m),d&&f(d,p,n),o=b[c](p,m),j[g]&&f(j[g],o,k),l(j[g],i,e,o,a),o},l=function(a,b,c,d,e){var f,g,h,j,k;if(a){j=_.keys(i),k=[];for(g=0,h=j.length;g<h;g++)f=j[g],k.push(o(f,i[f],a,b,c,d,e));return k}},o=function(a,b,c,d,e,f,g){var h;return h=c[a],h?f[b]=h.bind(d):f[b]=function(a){return g.eventChannel.publish({control:e,event:b,context:g}),a.stopPropagation()}},f=function(a,b,c){var d,f,g,h,i;h=_.keys(c),i=[];for(f=0,g=h.length;f<g;f++)d=h[f],i.push(e(a,b,d,c[d]));return i},e=function(a,b,c,d){var e,f,g,h,i;e=a[c];if(e){if(_.isArray(d)){i=[];for(g=0,h=d.length;g<h;g++)f=d[g],i.push(b[f]=e);return i}return b[d]=e}},this.map=function(a){var c;return c=g(this,a,b,this.element,this.map),c(this.html,a)},this};var g;g={"default":{onGet:function(a,b,c){return console.log("read: "+b+" -> "+c)},onSet:function(a,b,c,d){return console.log("wrote: "+b+". "+d+" -> "+c)},namespace:""},create:function(a,b,f,g){var h,i,j,k;return h=postal.channel(g+"_model"),i=b||(b=function(a,b,c){return h.publish({event:"read",parent:a,key:b,value:c})}),j=f||(f=function(a,b,c,d){return h.publish({event:"wrote",parent:a,key:b,value:c,original:d})}),g=g||(g=this["default"].namespace),k=c(a,function(){return new d(a,i,j,g)},function(){return new e(a,i,j,g)},function(){return a}),postal.channel(g+"_events").subscribe(function(a){if(a.event==="onchange")return k[a.control]=a.context[a.control].value}),k},scan:function(a,b){return domFactory(a,b)},map:function(a){return new f(a,"")}},a.replicant=g})(window)